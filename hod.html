<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>University Hall Booking System</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js'></script>
    
    <script src="https://unpkg.com/lucide@latest"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="css/styles.css">
    <style>
        /* Override FullCalendar styles to match theme */
        :root {
            --fc-border-color: rgba(100, 116, 139, 0.5);
            --fc-daygrid-event-dot-width: 8px;
            --fc-list-event-dot-width: 10px;
            --fc-event-bg-color: #3b82f6;
            --fc-event-border-color: #2563eb;
            --fc-event-text-color: #ffffff;
            --fc-page-bg-color: transparent;
            --fc-neutral-bg-color: rgba(30, 41, 59, 0.5);
            --fc-list-day-text-color: #ffffff;
            --fc-list-day-side-text-color: #9ca3af;
        }
        .fc .fc-toolbar-title {
            color: #ffffff;
        }
        .fc .fc-button-primary {
            background-color: #374151;
            border-color: #4b5563;
        }
        .fc .fc-button-primary:hover {
            background-color: #4b5563;
        }
        .fc .fc-daygrid-day-number, .fc .fc-col-header-cell-cushion {
            color: #d1d5db;
        }
        .fc-theme-standard .fc-list-day-cushion {
            background-color: rgba(15, 23, 42, 0.7);
        }
       .table-container table {
            table-layout: fixed;
            width: 100%;
        }

        .table-container td, .table-container th {
            overflow-wrap: break-word;
            word-wrap: break-word;
        }

        /* Give more space to columns with potentially long content */
        #approve-bookings-view th:nth-child(2),
        #approve-bookings-view th:nth-child(5) {
            width: 20%; 
        }

        #approve-bookings-view th:nth-child(4) {
            width: 22%;
        }

        /* FIX: Defined explicit widths for ALL columns to ensure proper alignment */
        #hall-details-view th:nth-child(1) { width: 4%; }  /* Checkbox */
        #hall-details-view th:nth-child(2) { width: 10%; } /* Date */
        #hall-details-view th:nth-child(3) { width: 18%; } /* Hall Details */
        #hall-details-view th:nth-child(4) { width: 18%; } /* Belongs to */
        #hall-details-view th:nth-child(5) { width: 20%; } /* Features */
        #hall-details-view th:nth-child(6) { width: 18%; } /* Incharge */
        #hall-details-view th:nth-child(7) { width: 12%; } /* Status */


        /* --- NEW: Aesthetically Pleasing Calendar Event Styles --- */
        .fc-event {
            border-radius: 6px !important;
            padding: 4px 8px !important;
            cursor: pointer;
            font-weight: 500 !important;
            border: none !important;
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .fc-event:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        .fc-event-main {
            color: #fff !important;
        }
        .fc-event-approved {
            background-color: rgba(34, 197, 94, 0.2) !important;
            border-left: 4px solid #22c55e !important;
        }
        .fc-event-rejected {
            background-color: rgba(239, 68, 68, 0.2) !important;
            border-left: 4px solid #ef4444 !important;
        }
        .fc-event-pending {
            background-color: rgba(245, 158, 11, 0.2) !important;
            border-left: 4px solid #f59e0b !important;
        }

        /* List View Customization */
        .fc .fc-list-event-dot {
            border-color: transparent !important; /* We use our own status colors */
        }
        .fc-list-event:hover td {
            background-color: rgba(30, 41, 59, 0.7) !important;
        }

        /* Custom Event Content Styling */
        .event-content {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            line-height: 1.2;
            width: 100%;
            overflow: hidden;
        }
        .event-time {
            font-weight: 600;
            color: #e2e8f0;
        }
        .event-title {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #cbd5e1;
        }

        /* Stat Card Hover Effect */
        .stat-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        /* --- NEW: Animation Styles --- */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-fade-in-up {
            animation: fadeInUp 0.5s ease-out forwards;
            opacity: 0;
        }

    </style>
</head>
<body class="min-h-screen flex flex-col bg-slate-900 text-slate-200">

    <div class="custom-cursor">
        <div class="cursor-dot"></div>
        <div class="cursor-outline"></div>
    </div>

    <div id="top-bars-container" class="sticky top-0 z-30 transition-transform duration-300 flex-shrink-0">
        <header class="bg-slate-900/80 backdrop-blur-sm shadow-lg">
            <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center space-x-4">
                        <img src="download.png" alt="University Logo" class="h-10 w-10 rounded-full bg-white p-1">
                        <span class="text-white font-bold text-xl hidden sm:block">PONDICHERRY UNIVERSITY</span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <span class="text-slate-300 hidden md:block" id="user-name-display"></span>
                        <a href="#" onclick="logout()" class="flex items-center text-slate-300 hover:text-white transition-colors duration-200">
                            <i data-lucide="log-out" class="w-5 h-5 mr-2"></i>
                            Logout
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <nav class="bg-slate-800/60 backdrop-blur-sm shadow-md">
            <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8">
                <div id="main-nav" class="flex items-center justify-center flex-wrap gap-x-1 md:gap-x-4 gap-y-2 py-3">
                    </div>
            </div>
        </nav>
    </div>

    <main id="dashboard-view" class="hidden flex-grow max-w-screen-2xl w-full mx-auto p-2 sm:p-4 lg:p-6">
        <div id="dashboard-content" class="h-full flex flex-col gap-6">
            <!-- Stat Cards -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 flex-shrink-0">
                <div class="stat-card bg-slate-800/50 p-6 rounded-2xl flex items-center gap-6 shadow-lg border border-slate-700/50 animate-fade-in-up" style="animation-delay: 0.1s;">
                    <div class="bg-blue-500/20 p-4 rounded-xl"><i data-lucide="calendar-check" class="w-8 h-8 text-blue-400"></i></div>
                    <div>
                        <p class="text-3xl font-bold text-white" id="stat-upcoming">0</p>
                        <p class="text-sm text-slate-400">Upcoming Bookings</p>
                    </div>
                </div>
                <div class="stat-card bg-slate-800/50 p-6 rounded-2xl flex items-center gap-6 shadow-lg border border-slate-700/50 animate-fade-in-up" style="animation-delay: 0.2s;">
                    <div class="bg-yellow-500/20 p-4 rounded-xl"><i data-lucide="clock-3" class="w-8 h-8 text-yellow-400"></i></div>
                    <div>
                        <p class="text-3xl font-bold text-white" id="stat-pending">0</p>
                        <p class="text-sm text-slate-400">Pending Approval</p>
                    </div>
                </div>
                 <div class="stat-card bg-slate-800/50 p-6 rounded-2xl flex items-center gap-6 shadow-lg border border-slate-700/50 animate-fade-in-up" style="animation-delay: 0.3s;">
                    <div class="bg-green-500/20 p-4 rounded-xl"><i data-lucide="check-check" class="w-8 h-8 text-green-400"></i></div>
                    <div>
                        <p class="text-3xl font-bold text-white" id="stat-total">0</p>
                        <p class="text-sm text-slate-400">Total Bookings</p>
                    </div>
                </div>
                <div class="stat-card bg-slate-800/50 p-6 rounded-2xl flex items-center gap-6 shadow-lg border border-slate-700/50 animate-fade-in-up" style="animation-delay: 0.4s;">
                    <div class="bg-red-500/20 p-4 rounded-xl"><i data-lucide="calendar-x" class="w-8 h-8 text-red-400"></i></div>
                    <div>
                        <p class="text-3xl font-bold text-white" id="stat-rejected">0</p>
                        <p class="text-sm text-slate-400">Rejected Bookings</p>
                    </div>
                </div>
            </div>
    
            <!-- Main Content Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 flex-grow min-h-0">
                <!-- Left Panel: Upcoming Bookings -->
                <div class="lg:col-span-1 bg-slate-800/50 p-6 rounded-2xl shadow-lg border border-slate-700/50 flex flex-col animate-fade-in-up min-h-0" style="animation-delay: 0.5s;">
                    <h2 class="text-xl font-bold text-white mb-4 flex-shrink-0">Upcoming Bookings</h2>
                    <div id="upcoming-bookings-list" class="space-y-4 overflow-y-auto flex-grow pr-2 -mr-4 pb-4">
                        <!-- Content will be injected by JS -->
                    </div>
                </div>
    
                <!-- Middle Panel: Calendar -->
                <div class="lg:col-span-2 bg-slate-800/50 p-6 rounded-2xl shadow-lg border border-slate-700/50 flex flex-col animate-fade-in-up min-h-0" style="animation-delay: 0.6s;">
                     <div id='calendar' class="w-full flex-grow overflow-y-auto"></div>
                </div>

                <!-- Right Panel: Recent Activity -->
                <div class="lg:col-span-1 bg-slate-800/50 p-6 rounded-2xl shadow-lg border border-slate-700/50 flex flex-col animate-fade-in-up min-h-0" style="animation-delay: 0.7s;">
                    <h2 class="text-xl font-bold text-white mb-4 flex-shrink-0">Recent Activity</h2>
                    <div id="activity-feed-list" class="space-y-5 overflow-y-auto flex-grow pr-2 -mr-4 pb-4">
                        <!-- Activity items injected by JS -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div id="hall-details-view" class="hidden flex-grow w-full p-2 sm:p-4 lg:p-6">
        <div class="bg-slate-800/50 rounded-xl shadow-2xl p-2 sm:p-4 lg:p-6 h-full flex flex-col">
            <h1 class="text-3xl font-bold text-white text-center mb-2 flex-shrink-0">Hall Details</h1>
            
            <div class="flex flex-col sm:flex-row items-center justify-between mb-1 gap-1 flex-shrink-0">
                <div class="flex items-center space-x-2">
                    <button id="status-btn" disabled class="glowing-btn flex items-center px-3 py-1.5 text-sm font-semibold text-white bg-yellow-600 hover:bg-yellow-700 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed">
                        <i data-lucide="toggle-right" class="w-4 h-4 mr-2"></i>Update Status
                    </button>
                    <button id="features-btn" disabled class="glowing-btn flex items-center px-3 py-1.5 text-sm font-semibold text-white bg-teal-600 hover:bg-teal-700 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed">
                        <i data-lucide="sparkles" class="w-4 h-4 mr-2"></i>Modify Features
                    </button>
                </div>
                <div class="flex items-center space-x-2">
                    <button id="clear-hall-filters-btn" class="flex items-center px-3 py-1.5 text-sm font-semibold text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-lg transition">
                        <i data-lucide="filter-x" class="w-4 h-4 mr-2"></i>Clear All Filters
                    </button>
                    <label for="multiselect-toggle" class="flex items-center cursor-pointer">
                        <span class="mr-2 text-sm font-medium text-slate-300">Multi-Select</span>
                        <div class="relative">
                            <input type="checkbox" id="multiselect-toggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-slate-600 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-500/50 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- FIX: Added overflow-x-auto to prevent layout breaking -->
            <div class="table-container flex-grow min-h-0 min-w-0 overflow-x-auto">
                <table class="min-w-full divide-y divide-slate-700">
                    <thead class="bg-slate-900/50 sticky top-0">
                        <tr>
                            <th scope="col" class="py-2.5 pl-4 pr-3 text-left text-sm font-semibold text-white sm:pl-6">
                                <input type="checkbox" id="select-all-checkbox" class="rounded bg-slate-700 border-slate-500 text-blue-500 focus:ring-blue-500" disabled>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Date <i data-filter-column="date" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Hall Details <i data-filter-column="hall" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Belongs to <i data-filter-column="belongsTo" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Features <i data-filter-column="features" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Incharge Details <i data-filter-column="incharge" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Status <i data-filter-column="status" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="hall-details-body" class="divide-y divide-slate-800 bg-slate-900/30"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    <div id="archive-view" class="hidden flex-grow w-full p-2 sm:p-4 lg:p-6">
        <div class="bg-slate-800/50 rounded-xl shadow-2xl p-2 sm:p-4 lg:p-6 h-full flex flex-col">
            <h1 class="text-3xl font-bold text-center mb-2 flex-shrink-0" style="color: #60a5fa;">Archived Hall Details</h1>
            
            <div class="flex flex-col sm:flex-row items-center justify-between mb-1 gap-1 flex-shrink-0">
                <div class="flex items-center space-x-2">
                    <button id="reactivate-btn" disabled class="glowing-btn flex items-center px-3 py-1.5 text-sm font-semibold text-white bg-green-600 hover:bg-green-700 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed">
                        <i data-lucide="check-circle" class="w-4 h-4 mr-2"></i>Re-activate
                    </button>
                </div>
                <div class="flex items-center space-x-2">
                     <button id="clear-archive-filters-btn" class="flex items-center px-3 py-1.5 text-sm font-semibold text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-lg transition">
                        <i data-lucide="filter-x" class="w-4 h-4 mr-2"></i>Clear All Filters
                    </button>
                    <label for="archive-multiselect-toggle" class="flex items-center cursor-pointer">
                        <span class="mr-2 text-sm font-medium text-slate-300">Multi-Select</span>
                        <div class="relative">
                            <input type="checkbox" id="archive-multiselect-toggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-slate-600 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-500/50 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                        </div>
                    </label>
                </div>
            </div>

            <div class="table-container flex-grow min-h-0 min-w-0">
                <table class="min-w-full divide-y divide-slate-700">
                     <thead class="bg-slate-900/50 sticky top-0">
                        <tr>
                            <th scope="col" class="py-2.5 pl-4 pr-3 text-left text-sm font-semibold text-white sm:pl-6">
                                <input type="checkbox" id="select-all-archive-checkbox" class="rounded bg-slate-700 border-slate-500 text-blue-500 focus:ring-blue-500" disabled>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Date <i data-filter-column="date" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Hall Details <i data-filter-column="hall" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Belongs to <i data-filter-column="belongsTo" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Features <i data-filter-column="features" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Incharge Details <i data-filter-column="incharge" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">Status</th>
                        </tr>
                    </thead>
                    <tbody id="archived-hall-details-body" class="divide-y divide-slate-800 bg-slate-900/30"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="employee-details-view" class="hidden flex-grow w-full p-2 sm:p-4 lg:p-6">
         <div class="bg-slate-800/50 rounded-xl shadow-2xl p-2 sm:p-4 lg:p-6 h-full flex flex-col">
            <h1 class="text-3xl font-bold text-center mb-2 flex-shrink-0" style="color: #60a5fa;">Employee Details</h1>
            
            <div class="flex flex-col sm:flex-row items-center justify-between mb-1 gap-1 flex-shrink-0">
                <div class="flex items-center space-x-2">
                    <button id="modify-employee-btn" disabled class="glowing-btn flex items-center px-3 py-1.5 text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed">
                        <i data-lucide="pencil" class="w-4 h-4 mr-2"></i>Modify
                    </button>
                    <button id="delete-employee-btn" disabled class="glowing-btn flex items-center px-3 py-1.5 text-sm font-semibold text-white bg-red-600 hover:bg-red-700 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed">
                        <i data-lucide="trash-2" class="w-4 h-4 mr-2"></i>Delete
                    </button>
                </div>
                <div class="flex items-center space-x-2">
                    <button id="clear-employee-filters-btn" class="flex items-center px-3 py-1.5 text-sm font-semibold text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-lg transition">
                        <i data-lucide="filter-x" class="w-4 h-4 mr-2"></i>Clear All Filters
                    </button>
                    <label for="employee-multiselect-toggle" class="flex items-center cursor-pointer">
                        <span class="mr-2 text-sm font-medium text-slate-300">Multi-Select</span>
                        <div class="relative">
                            <input type="checkbox" id="employee-multiselect-toggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-slate-600 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-500/50 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                        </div>
                    </label>
                </div>
            </div>

            <div class="table-container flex-grow min-h-0 min-w-0">
                <table class="min-w-full divide-y divide-slate-700">
                    <thead class="bg-slate-900/50 sticky top-0">
                        <tr>
                            <th scope="col" class="py-2.5 pl-4 pr-3 text-left text-sm font-semibold text-white sm:pl-6">
                                <input type="checkbox" id="select-all-employee-checkbox" class="rounded bg-slate-700 border-slate-500 text-blue-500 focus:ring-blue-500" disabled>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Employee Details <i data-filter-column="employee" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Designation <i data-filter-column="designation" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Office <i data-filter-column="office" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Status <i data-filter-column="status" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="employee-details-body" class="divide-y divide-slate-800 bg-slate-900/30"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="browse-book-view" class="hidden flex-grow w-full mx-auto p-2 sm:p-4 lg:p-6">
        <div class="bg-slate-800/50 rounded-xl shadow-2xl p-2 sm:p-4 lg:p-6 h-full flex flex-col">
            <h1 class="text-3xl font-bold text-center mb-6 flex-shrink-0" style="color: #60a5fa;">Browse & Book Hall</h1>
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 flex-grow min-h-0">
                <aside class="lg:col-span-1 space-y-4 browse-filter-panel pr-4">
                    <div>
                        <h3 class="text-lg font-semibold text-white mb-2">Hall Type:</h3>
                        <div id="hall-type-filters" class="grid grid-cols-2 gap-2">
                             <button data-hall-type="Seminar" class="hall-type-btn px-3 py-1.5 text-sm rounded-lg transition bg-slate-700 hover:bg-slate-600 text-slate-300">Seminar</button>
                             <button data-hall-type="Auditorium" class="hall-type-btn px-3 py-1.5 text-sm rounded-lg transition bg-slate-700 hover:bg-slate-600 text-slate-300">Auditorium</button>
                             <button data-hall-type="Lecture Hall" class="hall-type-btn px-3 py-1.5 text-sm rounded-lg transition bg-slate-700 hover:bg-slate-600 text-slate-300">Lecture Hall</button>
                             <button data-hall-type="Conference Hall" class="hall-type-btn px-3 py-1.5 text-sm rounded-lg transition bg-slate-700 hover:bg-slate-600 text-slate-300">Conference</button>
                        </div>
                    </div>
                    <div>
                        <label for="school-filter-input" class="block text-lg font-semibold text-white mb-2">School:</label>
                        <div class="relative">
                            <input type="text" id="school-filter-input" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white focus:ring-blue-500 focus:border-blue-500" placeholder="Search for a school...">
                            <div id="school-filter-options" class="absolute z-10 w-full bg-slate-800 border border-slate-600 rounded-lg mt-1 hidden max-h-60 overflow-y-auto"></div>
                        </div>
                        <input type="hidden" id="school-filter">
                    </div>
                    <div>
                        <label for="dept-filter-input" class="block text-lg font-semibold text-white mb-2">Department:</label>
                        <div class="relative">
                            <input type="text" id="dept-filter-input" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white focus:ring-blue-500 focus:border-blue-500" placeholder="Search for a department...">
                            <div id="dept-filter-options" class="absolute z-10 w-full bg-slate-800 border border-slate-600 rounded-lg mt-1 hidden max-h-60 overflow-y-auto"></div>
                        </div>
                        <input type="hidden" id="dept-filter">
                    </div>
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="text-lg font-semibold text-white">Capacity</h3>
                            <button id="clear-capacity" class="text-sm text-blue-400 hover:text-blue-300">Clear</button>
                        </div>
                        <div class="space-y-1">
                            <label class="flex items-center"><input type="radio" name="capacity" value="less-50" class="form-radio bg-slate-700 border-slate-600 text-blue-500 h-4 w-4 mr-2">Less than 50</label>
                            <label class="flex items-center"><input type="radio" name="capacity" value="50-100" class="form-radio bg-slate-700 border-slate-600 text-blue-500 h-4 w-4 mr-2">50 to 100</label>
                            <label class="flex items-center"><input type="radio" name="capacity" value="more-100" class="form-radio bg-slate-700 border-slate-600 text-blue-500 h-4 w-4 mr-2">More than 100</label>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="text-lg font-semibold text-white">Features</h3>
                            <button id="clear-features" class="text-sm text-blue-400 hover:text-blue-300">Clear</button>
                        </div>
                        <div class="space-y-1">
                            <label class="flex items-center"><input type="checkbox" data-feature="Projector" class="form-checkbox bg-slate-700 border-slate-600 rounded text-blue-500 h-4 w-4 mr-2">Projector</label>
                            <label class="flex items-center"><input type="checkbox" data-feature="Smartboard" class="form-checkbox bg-slate-700 border-slate-600 rounded text-blue-500 h-4 w-4 mr-2">Smartboard</label>
                            <label class="flex items-center"><input type="checkbox" data-feature="AC" class="form-checkbox bg-slate-700 border-slate-600 rounded text-blue-500 h-4 w-4 mr-2">AC</label>
                            <label class="flex items-center"><input type="checkbox" data-feature="Computer" class="form-checkbox bg-slate-700 border-slate-600 rounded text-blue-500 h-4 w-4 mr-2">Computer</label>
                            <label class="flex items-center"><input type="checkbox" data-feature="Audio System" class="form-checkbox bg-slate-700 border-slate-600 rounded text-blue-500 h-4 w-4 mr-2">Audio System</label>
                        </div>
                    </div>
                </aside>
                <div class="lg:col-span-3 flex flex-col">
                    <div class="flex-shrink-0">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-2">
                            <div class="relative">
                                <label for="from-date" class="block text-sm font-medium text-slate-300 mb-1">From:</label>
                                <input type="date" id="from-date" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div class="relative">
                                <label for="to-date" class="block text-sm font-medium text-slate-300 mb-1">To:</label>
                                <input type="date" id="to-date" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white focus:ring-blue-500 focus:border-blue-500">
                            </div>
                        </div>
                        <div class="bg-slate-900/50 p-3 rounded-lg mb-4">
                            <div class="flex justify-between items-center mb-2">
                                 <div class="flex gap-4">
                                    <button id="forenoon-btn" class="text-slate-400 hover:text-white font-semibold">Forenoon</button>
                                    <button id="afternoon-btn" class="text-slate-400 hover:text-white font-semibold">Afternoon</button>
                                </div>
                                <button id="clear-timeslots" class="text-sm text-blue-400 hover:text-blue-300">Clear Selection</button>
                            </div>
                            <div id="time-slot-buttons" class="grid grid-cols-2 sm:grid-cols-4 gap-2">
                                <button data-time="09:30 AM" class="px-3 py-1.5 text-sm rounded-lg bg-slate-700 hover:bg-slate-600 transition">09:30am</button>
                                <button data-time="10:30 AM" class="px-3 py-1.5 text-sm rounded-lg bg-slate-700 hover:bg-slate-600 transition">10:30am</button>
                                <button data-time="11:30 AM" class="px-3 py-1.5 text-sm rounded-lg bg-slate-700 hover:bg-slate-600 transition">11:30am</button>
                                <button data-time="12:30 PM" class="px-3 py-1.5 text-sm rounded-lg bg-slate-700 hover:bg-slate-600 transition">12:30pm</button>
                                <button data-time="01:30 PM" class="px-3 py-1.5 text-sm rounded-lg bg-slate-700 hover:bg-slate-600 transition">01:30pm</button>
                                <button data-time="02:30 PM" class="px-3 py-1.5 text-sm rounded-lg bg-slate-700 hover:bg-slate-600 transition">02:30pm</button>
                                <button data-time="03:30 PM" class="px-3 py-1.5 text-sm rounded-lg bg-slate-700 hover:bg-slate-600 transition">03:30pm</button>
                                <button data-time="04:30 PM" class="px-3 py-1.5 text-sm rounded-lg bg-slate-700 hover:bg-slate-600 transition">04:30pm</button>
                            </div>
                        </div>
                    </div>
                    <div class="flex-grow min-h-0 flex flex-col">
                        <div class="flex justify-between items-center mb-2 flex-shrink-0">
                            <h2 id="hall-listing-title" class="text-xl font-bold text-white"></h2>
                            <div class="flex items-center gap-2 text-sm">
                                <label for="view-mode-select" class="text-slate-300">View:</label>
                                <select id="view-mode-select" class="bg-slate-700 border border-slate-600 rounded-lg px-2 py-1 text-white focus:ring-blue-500 focus:border-blue-500">
                                    <option value="with-image">With Image</option>
                                    <option value="without-image">Without Image</option>
                                    <option value="table">Table</option>
                                </select>
                            </div>
                        </div>
                        <div id="hall-cards-container" class="grid grid-cols-1 md:grid-cols-2 gap-4 card-grid-scrollable flex-grow"></div>
                        <div id="hall-table-container" class="hidden table-container flex-grow min-h-0 min-w-0"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="semester-booking-view" class="hidden flex-grow w-full px-2 sm:px-4 lg:p-6">
        <div class="h-full flex flex-col">
            <h1 class="text-3xl font-bold text-white text-center mb-4 flex-shrink-0">Semester Booking</h1>
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 flex-grow min-h-0">
                <div id="semester-halls-panel" class="bg-slate-800/50 rounded-xl shadow-2xl p-2 sm:p-4 flex flex-col lg:col-span-5">
                    <h2 class="text-2xl font-bold text-white mb-2 flex-shrink-0">Select a Hall</h2>
                    <div id="semester-halls-container" class="space-y-4 flex-grow overflow-y-auto pr-2 min-h-0">
                    </div>
                </div>
                <div id="booking-panel-container" class="bg-slate-800/50 rounded-xl shadow-2xl p-2 sm:p-4 flex flex-col lg:col-span-7">
                </div>
            </div>
        </div>
    </div>

    <div id="my-bookings-view" class="hidden flex-grow w-full p-2 sm:p-4 lg:p-6">
        <div class="bg-slate-800/50 rounded-xl shadow-2xl p-2 sm:p-4 lg:p-6 h-full flex flex-col">
             <div class="flex justify-between items-center mb-2 flex-shrink-0">
                <h1 class="text-3xl font-bold text-white" style="color: #60a5fa;">My Bookings</h1>
                <div class="flex items-center space-x-2">
                    <button id="clear-my-bookings-filters-btn" class="flex items-center px-3 py-1.5 text-sm font-semibold text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-lg transition">
                        <i data-lucide="filter-x" class="w-4 h-4 mr-2"></i>Clear Filters
                    </button>
                    <button id="cancel-bookings-btn" disabled class="px-3 py-1.5 text-sm font-semibold text-white bg-red-600 hover:bg-red-700 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed">
                        <i data-lucide="trash-2" class="w-4 h-4 mr-2 inline-block"></i>Cancel
                    </button>
                </div>
            </div>
            <div class="table-container flex-grow min-h-0 min-w-0">
                <table class="min-w-full divide-y divide-slate-700">
                    <thead class="bg-slate-900/50 sticky top-0">
                        <tr>
                            <th scope="col" class="py-2.5 pl-4 pr-3 text-left text-sm font-semibold text-white sm:pl-6"><input type="checkbox" class="rounded bg-slate-700 border-slate-500 text-blue-500 focus:ring-blue-500"></th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Booked On <i data-filter-column="bookedOn" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Hall Details <i data-filter-column="hall" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Purpose <i data-filter-column="purpose" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Date & Time <i data-filter-column="dateTime" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Status <i data-filter-column="status" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="my-bookings-body" class="divide-y divide-slate-800 bg-slate-900/30"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="approve-bookings-view" class="hidden flex-grow w-full p-2 sm:p-4 lg:p-6">
        <div class="bg-slate-800/50 rounded-xl shadow-2xl p-2 sm:p-4 lg:p-6 h-full flex flex-col">
            <div class="flex flex-col sm:flex-row justify-between items-center mb-4 flex-shrink-0">
                <div class="flex items-center gap-4">
                    <h1 class="text-3xl font-bold text-white" style="color: #60a5fa;">Approve / Reject Bookings</h1>
                    <!-- New Switch Component -->
                    <div id="booking-type-switch" class="flex items-center bg-slate-700/50 rounded-full p-1 cursor-pointer">
                        <button data-type="internal" class="booking-type-btn bg-blue-600 text-white px-4 py-1.5 text-sm font-semibold rounded-full transition-all duration-300">My Department</button>
                        <button data-type="external" class="booking-type-btn text-slate-300 px-4 py-1.5 text-sm font-semibold rounded-full transition-all duration-300">Other Departments</button>
                    </div>
                </div>
                <button id="clear-approve-filters-btn" class="flex items-center px-3 py-1.5 text-sm font-semibold text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-lg transition mt-3 sm:mt-0">
                    <i data-lucide="filter-x" class="w-4 h-4 mr-2"></i>Clear Filters
                </button>
            </div>
            <div class="table-container flex-grow min-h-0 min-w-0 overflow-x-auto">
                <table class="min-w-full divide-y divide-slate-700">
                    <thead class="bg-slate-900/50 sticky top-0">
                        <tr>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Booked On <i data-filter-column="bookedOn" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Hall Details <i data-filter-column="hall" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Purpose <i data-filter-column="purpose" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Date & Time <i data-filter-column="dateTime" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                <span class="flex items-center gap-2">Booked By <i data-filter-column="bookedBy" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span>
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">
                                Status
                            </th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">Action</th>
                        </tr>
                    </thead>
                    <tbody id="approve-bookings-body" class="divide-y divide-slate-800 bg-slate-900/30"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- REMOVED: The entire booking-conflicts-view div has been deleted -->

    <div id="forward-bookings-view" class="hidden flex-grow w-full p-2 sm:p-4 lg:p-6">
        <div class="bg-slate-800/50 rounded-xl shadow-2xl p-2 sm:p-4 lg:p-6 h-full flex flex-col">
            <div class="flex justify-between items-center mb-2 flex-shrink-0">
                <h1 class="text-3xl font-bold text-white" style="color: #60a5fa;">Forward Bookings</h1>
                <button id="clear-forward-filters-btn" class="flex items-center px-3 py-1.5 text-sm font-semibold text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-lg transition">
                    <i data-lucide="filter-x" class="w-4 h-4 mr-2"></i>Clear Filters
                </button>
            </div>
            <div class="table-container flex-grow min-h-0 min-w-0 overflow-x-auto">
                <table class="min-w-full divide-y divide-slate-700">
                    <thead class="bg-slate-900/50 sticky top-0">
                        <tr>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white"><span class="flex items-center gap-2">Booked On <i data-filter-column="bookedOn" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span></th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white"><span class="flex items-center gap-2">Hall Details <i data-filter-column="hall" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span></th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white"><span class="flex items-center gap-2">Purpose <i data-filter-column="purpose" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span></th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white"><span class="flex items-center gap-2">Date & Time <i data-filter-column="dateTime" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span></th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white"><span class="flex items-center gap-2">Booked By <i data-filter-column="bookedBy" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span></th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white"><span class="flex items-center gap-2">Status <i data-filter-column="status" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span></th>
                            <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white">Action</th>
                        </tr>
                    </thead>
                    <tbody id="forward-bookings-body" class="divide-y divide-slate-800 bg-slate-900/30"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="view-bookings-view" class="hidden flex-grow w-full p-2 sm:p-4 lg:p-6">
            <div class="bg-slate-800/50 rounded-xl shadow-2xl p-2 sm:p-4 lg:p-6 h-full flex flex-col">
                <div class="flex justify-between items-center mb-2 flex-shrink-0">
                    <h1 class="text-3xl font-bold text-white" style="color: #60a5fa;">View All Bookings</h1>
                    <button id="clear-view-bookings-filters-btn" class="flex items-center px-3 py-1.5 text-sm font-semibold text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-lg transition">
                        <i data-lucide="filter-x" class="w-4 h-4 mr-2"></i>Clear Filters
                    </button>
                </div>
                <div class="table-container flex-grow min-h-0 min-w-0 overflow-x-auto">
                    <table class="min-w-full divide-y divide-slate-700">
                        <thead class="bg-slate-900/50 sticky top-0">
                            <tr>
                                <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white"><span class="flex items-center gap-2">Booked On <i data-filter-column="bookedOn" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span></th>
                                <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white"><span class="flex items-center gap-2">Hall Details <i data-filter-column="hall" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span></th>
                                <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white"><span class="flex items-center gap-2">Purpose <i data-filter-column="purpose" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span></th>
                                <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white"><span class="flex items-center gap-2">Date & Time <i data-filter-column="dateTime" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span></th>
                                <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white"><span class="flex items-center gap-2">Booked By <i data-filter-column="bookedBy" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span></th>
                                <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white"><span class="flex items-center gap-2">Belongs To <i data-filter-column="belongsTo" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span></th>
                                <th scope="col" class="px-3 py-2.5 text-left text-sm font-semibold text-white"><span class="flex items-center gap-2">Status <i data-filter-column="status" class="filter-icon cursor-pointer text-slate-400 hover:text-white" data-lucide="filter"></i></span></th>
                                <th scope="col" class="relative py-3.5 pl-3 pr-4 sm:pr-6"><span class="sr-only">Details</span></th>
                            </tr>
                        </thead>
                        <tbody id="view-bookings-body" class="divide-y divide-slate-800 bg-slate-900/30">
                            <!-- Booking rows will be inserted here by viewBookings.js -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="hall-booking-details-view" class="hidden flex-grow w-full p-2 sm:p-4 lg:p-6">
        <div class="bg-slate-800/50 rounded-xl shadow-2xl p-2 sm:p-4 lg:p-6 h-full flex flex-col">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-2 flex-shrink-0">
                <div id="booking-hall-details" class="bg-blue-900/30 p-3 rounded-lg border border-blue-700"></div>
                <div id="booking-hall-features" class="bg-green-900/30 p-3 rounded-lg border border-green-700"></div>
                <div id="booking-hall-incharge" class="bg-yellow-900/30 p-3 rounded-lg border border-yellow-700"></div>
            </div>

            <div class="text-center mb-2 flex-shrink-0">
                <h2 class="text-2xl font-bold text-white">Booking Details</h2>
                <div class="flex items-center justify-center gap-4 mt-2">
                    <button id="prev-month-btn" class="p-2 rounded-md bg-slate-700 hover:bg-slate-600 transition">&lt;</button>
                    <span id="current-month-year" class="text-xl font-semibold text-white">July 2025</span>
                    <button id="next-month-btn" class="p-2 rounded-md bg-slate-700 hover:bg-slate-600 transition">&gt;</button>
                </div>
            </div>

            <div id="booking-calendar-grid" class="table-container overflow-auto pb-2 flex-grow"></div>

            <div class="flex items-center justify-center gap-x-4 gap-y-2 flex-wrap mt-2 text-sm flex-shrink-0">
                <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-green-500/80 mr-2"></span>Available</div>
                <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-cyan-500/80 mr-2"></span>Selected</div>
                <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-yellow-500/80 mr-2"></span>Pending</div>
                <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-red-600/80 mr-2"></span>Booked</div>
                <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-gray-700/50 mr-2"></span>Past</div>
            </div>

            <div class="flex items-center justify-center gap-4 mt-4 flex-shrink-0">
                <button onclick="window.history.back()" class="px-6 py-2 text-sm font-semibold text-white bg-slate-600 hover:bg-slate-700 rounded-lg transition">Back</button>
                <button id="confirm-booking-btn" class="px-6 py-2 text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition">Book</button>
            </div>
        </div>
    </div>

    <div id="final-booking-form-view" class="hidden flex-grow w-full p-2 sm:p-4 lg:p-6">
        <div class="bg-slate-800/50 rounded-xl shadow-2xl p-6 text-slate-200 h-full flex flex-col">
            <h1 class="text-3xl font-bold text-center mb-6 text-white flex-shrink-0">Hall Booking</h1>
            <div id="final-booking-form-content" class="space-y-4 flex-grow overflow-y-auto pr-2 min-h-0"></div>
        </div>
    </div>

    <footer class="bg-slate-900 text-center py-3 mt-auto">
        <p class="text-slate-400 text-sm">&copy; 2025 Pondicherry University. All rights reserved.</p>
    </footer>

    <div id="modal-backdrop" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-40 hidden opacity-0 transition-opacity duration-300"></div>
    
    <!-- NEW: Conflict Resolution Modal -->
    <div id="conflict-resolution-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden">
        <div class="modal-content relative bg-slate-800 rounded-lg shadow-xl max-w-4xl w-full p-6 transform transition-all">
            <h3 class="text-xl font-bold text-red-400 mb-4">Booking Conflict Detected</h3>
            <p class="text-slate-300 mb-4">The following booking requests clash for the same time slot. Please choose one to approve (which will automatically reject the others) or reject them all.</p>
            
            <div id="conflict-list-container" class="space-y-3 max-h-[60vh] overflow-y-auto pr-2">
                <!-- Conflict items will be injected here by JS -->
            </div>

            <div class="mt-6 flex justify-end gap-4">
                <button class="modal-close-btn px-4 py-2 text-sm font-semibold text-slate-300 bg-slate-600 hover:bg-slate-700 rounded-lg transition">Cancel</button>
            </div>
        </div>
    </div>

    <div id="confirmation-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden opacity-0 transition-opacity duration-300">
        <div class="modal-content relative bg-slate-800 rounded-lg shadow-xl max-w-sm w-full p-6 transform transition-all duration-300 scale-95">
            <h3 id="confirmation-title" class="text-lg font-bold text-white mb-2">Confirm Action</h3>
            <p id="confirmation-message" class="text-slate-300 mb-6">Are you sure you want to proceed?</p>
            <div class="flex justify-end gap-4">
                <button id="confirmation-cancel-btn" class="px-4 py-2 text-sm font-semibold text-slate-300 bg-slate-600 hover:bg-slate-700 rounded-lg transition">Cancel</button>
                <button id="confirmation-confirm-btn" class="px-4 py-2 text-sm font-semibold text-white bg-red-600 hover:bg-red-700 rounded-lg transition">Confirm</button>
            </div>
        </div>
    </div>

    <div id="update-status-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden">
        <div class="modal-content relative bg-slate-800 rounded-lg shadow-xl max-w-md w-full p-6 transform transition-all">
            <h3 class="text-lg font-bold text-white mb-4">Update Hall Status</h3>
            <div class="space-y-4 text-slate-300">
                <p>Select the new status for the selected hall(s).</p>
                <fieldset class="flex gap-6">
                    <label class="flex items-center"><input type="radio" name="status-option" value="true" class="form-radio h-4 w-4 bg-slate-700 border-slate-600 text-green-500 focus:ring-green-500 mr-2">Available</label>
                    <label class="flex items-center"><input type="radio" name="status-option" value="false" class="form-radio h-4 w-4 bg-slate-700 border-slate-600 text-red-500 focus:ring-red-500 mr-2">Unavailable</label>
                </fieldset>
                <div id="status-reason-container" class="hidden">
                    <label for="status-reason-select" class="block text-sm font-medium mb-1">Reason for Unavailability</label>
                    <select id="status-reason-select" class="glowing-select w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white">
                        <option value="">Select a reason...</option>
                        <!-- BUG FIX STARTS HERE: Values updated to match API requirements -->
                        <option value="AWAITING_INAUGURATION">Awaiting Inauguration</option>
                        <option value="UNDER_CONSTRUCTION">Under Construction</option>
                        <option value="UNDER_MAINTENANCE">Under Maintenance</option>
                        <option value="RESERVED_FOR_EVENTS">Reserved for University Event</option>
                        <option value="DAMAGED_OR_UNUSABLE">Damaged/Unusable</option>
                        <option value="REMOVED_FROM_SERVICE">Permanently Removed from Service</option>
                        <!-- BUG FIX ENDS HERE -->
                    </select>
                </div>
                <div id="status-date-range" class="hidden grid grid-cols-2 gap-4">
                    <div>
                        <label for="status-from-date" class="block text-sm font-medium mb-1">From</label>
                        <input type="date" id="status-from-date" class="glowing-input w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white">
                    </div>
                    <div>
                        <label for="status-to-date" class="block text-sm font-medium mb-1">To</label>
                        <input type="date" id="status-to-date" class="glowing-input w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white">
                    </div>
                </div>
            </div>
            <div class="mt-6 flex justify-end gap-4">
                <button class="modal-close-btn px-4 py-2 text-sm font-semibold text-slate-300 bg-slate-600 hover:bg-slate-700 rounded-lg transition">Cancel</button>
                <button id="submit-status-update" class="glowing-btn px-4 py-2 text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition">Update</button>
            </div>
        </div>
    </div>

    <div id="transfer-ownership-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden">
    </div>

    <div id="modify-features-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden">
        <div class="modal-content relative bg-slate-800 rounded-lg shadow-xl max-w-md w-full p-6 transform transition-all">
            <div class="flex justify-between items-start">
                <h3 class="text-lg font-bold text-white mb-4">Modify Features</h3>
                <button id="clear-all-features" class="text-xs text-blue-400 hover:text-blue-300">Clear All</button>
            </div>
            <p class="text-slate-300 mb-4">Select the features available in this hall. (Only single selection is allowed)</p>
            <div id="features-checkbox-container" class="grid grid-cols-2 sm:grid-cols-3 gap-4 max-h-60 overflow-y-auto pr-2">
            </div>
            <div class="mt-6 flex justify-end gap-4">
                <button class="modal-close-btn px-4 py-2 text-sm font-semibold text-slate-300 bg-slate-600 hover:bg-slate-700 rounded-lg transition">Cancel</button>
                <button id="submit-features-update" class="glowing-btn px-4 py-2 text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition">Save Features</button>
            </div>
        </div>
    </div>

    <div id="update-employee-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden opacity-0 transition-opacity duration-300">
        <div class="modal-content relative bg-slate-800 rounded-lg shadow-xl max-w-2xl w-full p-8 transform transition-all duration-300 scale-95">
            <h2 class="text-3xl font-bold text-center text-blue-400 mb-6">Update Employee</h2>
            <div class="border-t border-blue-800/50 mb-6"></div>
            <form id="update-employee-form" class="space-y-4 max-h-[70vh] overflow-y-auto pr-4">
                <input type="hidden" id="update-employee-id">
                <div>
                    <label for="update-employee-name" class="block text-sm font-medium text-slate-300">Employee Name:</label>
                    <input type="text" id="update-employee-name" class="mt-1 block w-full bg-slate-700 border border-slate-600 rounded-md shadow-sm py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                <div>
                    <label for="update-employee-email" class="block text-sm font-medium text-slate-300">Email:</label>
                    <input type="email" id="update-employee-email" class="mt-1 block w-full bg-slate-700 border border-slate-600 rounded-md shadow-sm py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                <div>
                    <label for="update-employee-phone" class="block text-sm font-medium text-slate-300">Employee Contact:</label>
                    <input type="text" id="update-employee-phone" class="mt-1 block w-full bg-slate-700 border border-slate-600 rounded-md shadow-sm py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                <div>
                    <label for="update-employee-designation-select" class="block text-sm font-medium text-slate-300">Designation:</label>
                    <select id="update-employee-designation-select" class="mt-1 block w-full bg-slate-700 border border-slate-600 rounded-md shadow-sm py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500">
                        <option value="HOD">HOD</option>
                        <option value="ADMIN">Admin</option>
                        <option value="DEAN">Dean</option>
                        <option value="PROF">Professor</option>
                        <option value="REGISTER">Register</option>
                        <option value="FACULTY">Faculty</option>
                        <option value="OTHERS">Others</option>
                    </select>
                </div>
                 <div>
                    <label class="block text-sm font-medium text-slate-300">Status:</label>
                    <div class="mt-2 flex gap-x-6">
                         <label class="flex items-center"><input type="radio" name="update-employee-status" value="ACTIVE" class="h-4 w-4 text-indigo-600 border-gray-500 focus:ring-indigo-500"><span class="ml-2 text-slate-300">Active</span></label>
                         <label class="flex items-center"><input type="radio" name="update-employee-status" value="INACTIVE" class="h-4 w-4 text-indigo-600 border-gray-500 focus:ring-indigo-500"><span class="ml-2 text-slate-300">Inactive</span></label>
                    </div>
                </div>
                <div>
                    <label for="update-employee-belongs-to" class="block text-sm font-medium text-slate-300">Belongs to:</label>
                    <select id="update-employee-belongs-to" class="mt-1 block w-full bg-slate-700 border border-slate-600 rounded-md shadow-sm py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500">
                        <option value="ADMINISTRATION">Administration</option>
                        <option value="SCHOOL">School</option>
                        <option value="DEPARTMENT">Department</option>
                    </select>
                </div>

                <div id="update-employee-section-container">
                    <label for="update-employee-section-select" class="block text-sm font-medium text-slate-300">Section:</label>
                    <select id="update-employee-section-select" class="mt-1 block w-full bg-slate-700 border border-slate-600 rounded-md shadow-sm py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500">
                        <option value="" disabled>Select a section</option>
                        <option value="ENGINEERING_WING">Engineering Wing</option>
                        <option value="EXAMINATION_WING">Examination Wing</option>
                        <option value="LIBRARY">Library</option>
                        <option value="GUEST_HOUSE">Guest House</option>
                    </select>
                </div>

                <div id="update-employee-school-container">
                    <label for="update-employee-school-input" class="block text-sm font-medium text-slate-300">School:</label>
                    <div class="relative mt-1">
                        <input type="text" id="update-employee-school-input" class="w-full bg-slate-700 border border-slate-600 rounded-md shadow-sm py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500" placeholder="Search for a school...">
                        <div id="update-employee-school-options" class="absolute z-20 w-full bg-slate-900 border border-slate-600 rounded-lg mt-1 hidden max-h-60 overflow-y-auto"></div>
                    </div>
                </div>

                 <div id="update-employee-department-container">
                    <label for="update-employee-department-input" class="block text-sm font-medium text-slate-300">Department:</label>
                    <div class="relative mt-1">
                        <input type="text" id="update-employee-department-input" class="w-full bg-slate-700 border border-slate-600 rounded-md shadow-sm py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500" placeholder="Search for a department...">
                        <div id="update-employee-department-options" class="absolute z-10 w-full bg-slate-900 border border-slate-600 rounded-lg mt-1 hidden max-h-60 overflow-y-auto"></div>
                    </div>
                </div>

                <div class="flex justify-center pt-6">
                    <button type="button" class="modal-close-btn px-6 py-2 text-sm font-semibold text-slate-300 bg-slate-600 hover:bg-slate-700 rounded-lg transition mr-4">Cancel</button>
                    <button type="submit" id="submit-employee-update" class="px-6 py-2 text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition">Update Employee</button>
                </div>
            </form>
        </div>
    </div>

    <div id="filter-modal-container"></div>

    <div id="filter-hall-details-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden"></div>
    <div id="filter-purpose-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden"></div>
    <div id="filter-booked-on-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden"></div>
    <div id="filter-datetime-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden"></div>
    <div id="filter-organiser-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden"></div>
    <div id="filter-status-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 hidden"></div>

    <script>
        // Inlined config to fix syntax errors in the original config.js file
        const AppConfig = {
            apiBaseUrl: 'https://hall-management.nirmaljyotib.workers.dev/',
            endpoints: {
                login: 'auth/login',
                hall: 'api/hall',
                allHall: 'api/hall/all-hall',
                addHall: 'api/hall/create',
                school: 'api/school',
                allschool: 'api/school/all-schools',
                addschool: 'api/school/create',
                department: 'api/department',
                alldept: 'api/department/all-department',
                addDept: 'api/department/create',
                emp:'api/employee',
                allemp: 'api/employee/all-employees',
                addemp: 'api/employee/create',
                booking: 'api/booking',
                bookingRequest: 'api/booking/request',
                myBookings: 'api/booking/my-requests',
                pendingApprovals: 'api/booking/pending-approval',
                pendingExternalApprovals: 'api/booking/pending-approval/external', // Added for external requests
                // NOTE: The following new endpoints are assumed to exist based on the new logic.
                // You will need to implement them in your backend API.
                bookingConflicts: 'api/booking/{id}/conflicts', 
                resolveConflict: 'api/booking/resolve-conflict'
            },
            links: {
                login: 'index.html'
            }
        };
    </script>
    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/api.js"></script>
    
    <script src="js/calendar.js"></script>
    <script src="js/nav.js"></script>
    <script src="js/utils/filters.js"></script>
    <script src="js/views/dashboard.js"></script>
    <script src="js/views/hallDetails.js"></script>
    <script src="js/views/archive.js"></script>
    <script src="js/views/employee.js"></script>
    <script src="js/views/browseBook.js"></script>
    <script src="js/views/semesterBooking.js"></script>
    <script src="js/views/myBookings.js"></script>
    <script src="js/views/approveBookings.js"></script>
    <!-- REMOVED: The script for conflicts.js has been deleted -->
    <script src="js/views/forward.js"></script>
    <script src="js/views/viewBookings.js"></script>
    <script src="js/views/hallBookingDetails.js"></script>
    <script src="js/views/finalBookingForm.js"></script>
    <script src="js/main.js"></script>
    
</body>
</html>
